{% extends 'base.html.twig' %}

{% block title %}Blog{% endblock %}

{% block body %}

    <div class="container mx-auto px-4 py-8">
        <a href="{{ path("home") }}">{% trans %}Retour{% endtrans %}</a>
        <section class="py-12">
            <article class="bg-gray-100 p-8 rounded-xl">
                <h2 class="text-lg font-bold">{{ article.title }}</h2>
                <p class="text-gray-500 text-sm">{% trans %}Ecrit le{% endtrans %} {{ article.createdAt | date('d/m/y') }} {% trans %}à{% endtrans %} {{ article.createdAt | date('H:i') }} {% trans %}par{% endtrans %} {{ article.createdBy }}. - #{{ article.category.title }}</p>
                <img class="my-4" src="{{ asset('uploads/images/' ~ article.image) }}" alt="{{ article.title }}">
                <p>{{ article.content | raw }}</p>
            </article>
            {% if app.user %}
                <a class="px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 mt-4 ml-auto inline-block" href="{{ path("edit_article", {'id': article.id})}}">{% trans %}Modifier l'article{% endtrans %}</a>
            {% elseif not app.user and edit_mode %}
                <a onclick="document.getElementById('error-div').style.display = 'flex'; return false;" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 mt-4 ml-auto inline-block" href="{{ path("edit_article", {'id': article.id})}}">{% trans %}Modifier l'article{% endtrans %}</a>
            {% endif %}

            {% if app.user %}
              <a class="px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 mt-4 ml-auto inline-block" href="{{ path("article_delete", {'id': article.id})}}">{% trans %}Supprimer l'article{% endtrans %}</a>
            {% endif %}
        </section>
        <div id="error-div" class="h-12 bg-red-400 rounded hidden items-center justify-center w-1/2">
            <p class="text-white"><a class="font-bold" href="{{ path('security_login') }}">{% trans %}Connectez-vous </a>si vous souhaitez modifier un article{% endtrans %}</p>
        </div>
        <section class="py-12">
            <h2 class="text-lg font-bold">{{ article.comments | length }} {% if article.comments | length is same as 0 %}{% trans %}commentaire{% endtrans %} {% else %} {% trans %}commentaires{% endtrans %}{% endif %}</h2>
            {% for comment in article.comments %}
              <div class="py-8">
                  <p class="text-gray-500 text-sm">{% trans %}Par{% endtrans %} {{ comment.author }}, {% trans %}le{% endtrans %} {{ comment.createdAt | date('d/m/y') }} {% trans %}à{% endtrans %} {{ comment.createdAt | date('H:i') }}</p>
                  <p>{{ comment.content | raw }}</p>
              </div>
              <span class="block w-full bg-gray-300 h-0.5"></span>
            {% endfor %}

            <div class="py-8">
                {% if app.user %}
                    <h2 class="text-md font-bold mb-2 text-center">{% trans %}Poster un commentaire{% endtrans %}</h2>
                    {{ form_start(form_comment) }}
                    {{ form_row(form_comment.author, {'label':'Votre nom'|trans, 'attr': {'placeholder': 'Votre nom'|trans}}) }}
                    {{ form_row(form_comment.content, {'label':'Votre message'|trans, 'label':'Votre message'|trans, 'attr': {'placeholder': 'Votre commentaire'|trans}}) }}
                    <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 mt-4">{% trans %}Commenter{% endtrans %}</button>
                    {{ form_end(form_comment) }}
                {% else %}
                    <h2 class="text-lg font-bold"><a class="text-indigo-600" href="{{ path('security_login') }}">{% trans %}Connectez-vous </a>si vous souhaitez poster un commentaire !{% endtrans %}</h2>
                {% endif %}
            </div>
        </section>
    </div>

{% endblock %}
